import{v as w,x as ie,p as ne,m as se,o as y,y as M,k as P,z as J,A as le,B as Be,C as Ne,F as S,D as Se,E as m,G as Z,H as x,I as ae,J as L,K as T,L as k,M as K,N as _,O as Ie,_ as Re,f as Y,i as O,w as Q,b as H,c as D,a as ee,r as B,d as N,u as Ze,j as $,P as Ae,Q as G}from"./index-f2fd0a46.js";import{g as ge}from"./global-867567d1.js";let q=Symbol("map"),j=Symbol("api"),Pe=Symbol("marker"),Ee=Symbol("markerCluster"),V=Symbol("CustomMarker"),Le=Symbol("mapTilesLoaded"),E="click dblclick drag dragend dragstart mousedown mousemove mouseout mouseover mouseup rightclick".split(" ");var $e=function i(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r;if(Array.isArray(e)){var o=e.length;if(o!=t.length)return!1;for(r=o;r--!==0;)if(!i(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var n=Object.keys(e);if(o=n.length,o!==Object.keys(t).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;for(r=o;r--!==0;)if(o=n[r],!i(e[o],t[o]))return!1;return!0}return e!==e&&t!==t};class b{constructor({apiKey:e,channel:t,client:r,id:o="__googleMapsScriptId",libraries:n=[],language:a,region:s,version:d,mapIds:l,nonce:u,retries:p=3,url:c="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.loading=this.done=!1,this.errors=[],this.version=d,this.apiKey=e,this.channel=t,this.client=r,this.id=o||"__googleMapsScriptId",this.libraries=n,this.language=a,this.region=s,this.mapIds=l,this.nonce=u,this.retries=p,this.url=c,b.instance){if(!$e(this.options,b.instance.options))throw Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(b.instance.options)}`);return b.instance}b.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+=`?callback=${this.CALLBACK}`,this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),0<this.libraries.length&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),e}deleteScript(){let e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(r=>{r?t(r.error):e(window.google)})})}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){if(document.getElementById(this.id))this.callback();else{var e=this.createUrl(),t=document.createElement("script");t.id=this.id,t.type="text/javascript",t.src=e,t.onerror=this.loadErrorCallback.bind(this),t.defer=!0,t.async=!0,this.nonce&&(t.nonce=this.nonce),document.head.appendChild(t)}}reset(){this.deleteScript(),this.loading=this.done=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){this.errors.push(e),this.errors.length<=this.retries?(e=this.errors.length*Math.pow(2,this.errors.length),console.log(`Failed to load Google Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)):(this.onerrorEvent=e,this.callback())}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){this.resetIfRetryingFailed(),this.done?this.callback():window.google&&window.google.maps&&window.google.maps.version?(console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback()):this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}function Fe(i){return class extends i.OverlayView{constructor(e){super();let{element:t,...r}=e;this.element=t,this.opts=r,this.opts.map&&this.setMap(this.opts.map)}getPosition(){return this.opts.position?this.opts.position instanceof i.LatLng?this.opts.position:new i.LatLng(this.opts.position):null}getVisible(){if(!this.element)return!1;let e=this.element;return e.style.display!=="none"&&e.style.visibility!=="hidden"&&(e.style.opacity===""||.01<Number(e.style.opacity))}onAdd(){if(this.element){var e=this.getPanes();e&&e.overlayMouseTarget.appendChild(this.element)}}draw(){if(this.element){var e=this.getProjection().fromLatLngToDivPixel(this.getPosition());if(e){this.element.style.position="absolute";let r=this.element.offsetHeight;var t=this.element.offsetWidth;switch(this.opts.anchorPoint){case"TOP_CENTER":t=e.x-t/2,e=e.y;break;case"BOTTOM_CENTER":t=e.x-t/2,e=e.y-r;break;case"LEFT_CENTER":t=e.x,e=e.y-r/2;break;case"RIGHT_CENTER":t=e.x-t,e=e.y-r/2;break;case"TOP_LEFT":t=e.x,e=e.y;break;case"TOP_RIGHT":t=e.x-t,e=e.y;break;case"BOTTOM_LEFT":t=e.x,e=e.y-r;break;case"BOTTOM_RIGHT":t=e.x-t,e=e.y-r;break;default:t=e.x-t/2,e=e.y-r/2}this.element.style.left=t+"px",this.element.style.top=e+"px",this.element.style.transform=`translateX(${this.opts.offsetX||0}px) translateY(${this.opts.offsetY||0}px)`,this.opts.zIndex&&(this.element.style.zIndex=this.opts.zIndex.toString())}}}onRemove(){this.element&&this.element.remove()}setOptions(e){this.opts=e,this.draw()}}}let ve,fe="bounds_changed center_changed click dblclick drag dragend dragstart heading_changed idle maptypeid_changed mousemove mouseout mouseover projection_changed resize rightclick tilesloaded tilt_changed zoom_changed".split(" ");var ue=w({props:{apiPromise:{type:Promise},apiKey:{type:String,default:""},version:{type:String,default:"weekly"},libraries:{type:Array,default:()=>["places"]},region:{type:String,required:!1},language:{type:String,required:!1},backgroundColor:{type:String,required:!1},center:{type:Object,default:()=>({lat:0,lng:0})},clickableIcons:{type:Boolean,required:!1,default:void 0},controlSize:{type:Number,required:!1},disableDefaultUi:{type:Boolean,required:!1,default:void 0},disableDoubleClickZoom:{type:Boolean,required:!1,default:void 0},draggable:{type:Boolean,required:!1,default:void 0},draggableCursor:{type:String,required:!1},draggingCursor:{type:String,required:!1},fullscreenControl:{type:Boolean,required:!1,default:void 0},fullscreenControlPosition:{type:String,required:!1},gestureHandling:{type:String,required:!1},heading:{type:Number,required:!1},keyboardShortcuts:{type:Boolean,required:!1,default:void 0},mapTypeControl:{type:Boolean,required:!1,default:void 0},mapTypeControlOptions:{type:Object,required:!1},mapTypeId:{type:[Number,String],required:!1},mapId:{type:String,required:!1},maxZoom:{type:Number,required:!1},minZoom:{type:Number,required:!1},noClear:{type:Boolean,required:!1,default:void 0},panControl:{type:Boolean,required:!1,default:void 0},panControlPosition:{type:String,required:!1},restriction:{type:Object,required:!1},rotateControl:{type:Boolean,required:!1,default:void 0},rotateControlPosition:{type:String,required:!1},scaleControl:{type:Boolean,required:!1,default:void 0},scaleControlStyle:{type:Number,required:!1},scrollwheel:{type:Boolean,required:!1,default:void 0},streetView:{type:Object,required:!1},streetViewControl:{type:Boolean,required:!1,default:void 0},streetViewControlPosition:{type:String,required:!1},styles:{type:Array,required:!1},tilt:{type:Number,required:!1},zoom:{type:Number,required:!1},zoomControl:{type:Boolean,required:!1,default:void 0},zoomControlPosition:{type:String,required:!1}},emits:fe,setup(i,{emit:e}){let t=m(),r=m(!1),o=m(),n=m(),a=m(!1);Z(q,o),Z(j,n),Z(Le,a);let s=()=>{const u={...i};Object.keys(u).forEach(c=>{u[c]===void 0&&delete u[c]});var p=c=>{var h;return c?{position:(h=n.value)===null||h===void 0?void 0:h.ControlPosition[c]}:{}};return p={scaleControlOptions:i.scaleControlStyle?{style:i.scaleControlStyle}:{},panControlOptions:p(i.panControlPosition),zoomControlOptions:p(i.zoomControlPosition),rotateControlOptions:p(i.rotateControlPosition),streetViewControlOptions:p(i.streetViewControlPosition),fullscreenControlOptions:p(i.fullscreenControlPosition),disableDefaultUI:i.disableDefaultUi},{...u,...p}},d=x([n,o],([u,p])=>{u&&p&&(u.event.addListenerOnce(p,"tilesloaded",()=>{a.value=!0}),setTimeout(d,0))},{immediate:!0}),l=u=>{n.value=_(u.maps),o.value=_(new u.maps.Map(t.value,s())),u=Fe(n.value),n.value[V]=u,fe.forEach(p=>{var c;(c=o.value)===null||c===void 0||c.addListener(p,h=>e(p,h))}),r.value=!0,u=Object.keys(i).filter(p=>!"apiPromise apiKey version libraries region language center zoom".split(" ").includes(p)).map(p=>T(i,p)),x([()=>i.center,()=>i.zoom,...u],([p,c],[h,g])=>{var v,f,C;const{center:me,zoom:X,...ze}=s();(v=o.value)===null||v===void 0||v.setOptions(ze),c!==void 0&&c!==g&&((f=o.value)===null||f===void 0||f.setZoom(c)),c=!h||p.lng!==h.lng||p.lat!==h.lat,p&&c&&((C=o.value)===null||C===void 0||C.panTo(p))})};return ae(()=>{if(i.apiPromise&&i.apiPromise instanceof Promise)i.apiPromise.then(l);else{try{const{apiKey:u,region:p,version:c,language:h,libraries:g}=i;ve=new b({apiKey:u,region:p,version:c,language:h,libraries:g})}catch(u){console.error(u)}ve.load().then(l)}}),L(()=>{var u;a.value=!1,o.value&&((u=n.value)===null||u===void 0||u.event.clearInstanceListeners(o.value))}),{mapRef:t,ready:r,map:o,api:n,mapTilesLoaded:a}}});function pe(i,e){if(e===void 0&&(e={}),e=e.insertAt,i&&typeof document<"u"){var t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}pe(`
.mapdiv[data-v-177d06e3] {
  width: 100%;
  height: 100%;
}
`);let He=ie();ne("data-v-177d06e3");let De={ref:"mapRef",class:"mapdiv"};se();let Ge=He(i=>(y(),M("div",null,[P("div",De,null,512),J(i.$slots,"default",{ready:i.ready,map:i.map,api:i.api,mapTilesLoaded:i.mapTilesLoaded},void 0,!0)])));ue.render=Ge;ue.__scopeId="data-v-177d06e3";var F=function i(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r;if(Array.isArray(e)){var o=e.length;if(o!=t.length)return!1;for(r=o;r--!==0;)if(!i(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var n=Object.keys(e);if(o=n.length,o!==Object.keys(t).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;for(r=o;r--!==0;)if(o=n[r],!i(e[o],t[o]))return!1;return!0}return e!==e&&t!==t};let z=(i,e,t,r)=>{const o=m(),n=k(q,m()),a=k(j,m()),s=k(Ee,m()),d=K(()=>!!(s.value&&a.value&&(o.value instanceof a.value.Marker||o.value instanceof a.value[V])));return x([n,t],(l,[u,p])=>{var c,h,g;l=!F(t.value,p)||n.value!==u,n.value&&a.value&&l&&(o.value?(o.value.setOptions(t.value),d.value&&((c=s.value)===null||c===void 0||c.removeMarker(o.value),(h=s.value)===null||h===void 0||h.addMarker(o.value))):(o.value=i==="Marker"?_(new a.value[i](t.value)):i===V?_(new a.value[i](t.value)):_(new a.value[i]({...t.value,map:n.value})),d.value?(g=s.value)===null||g===void 0||g.addMarker(o.value):o.value.setMap(n.value),e.forEach(v=>{var f;(f=o.value)===null||f===void 0||f.addListener(v,C=>r(v,C))})))},{immediate:!0}),L(()=>{var l,u;o.value&&((l=a.value)===null||l===void 0||l.event.clearInstanceListeners(o.value),d.value?(u=s.value)===null||u===void 0||u.removeMarker(o.value):o.value.setMap(null))}),o},ye="animation_changed click dblclick rightclick dragstart dragend drag mouseover mousedown mouseout mouseup draggable_changed clickable_changed contextmenu cursor_changed flat_changed rightclick zindex_changed icon_changed position_changed shape_changed title_changed visible_changed".split(" ");var Ue=w({name:"Marker",props:{options:{type:Object,required:!0}},emits:ye,setup(i,{emit:e,expose:t,slots:r}){return i=T(i,"options"),e=z("Marker",ye,i,e),Z(Pe,e),t({marker:e}),()=>{var o;return(o=r.default)===null||o===void 0?void 0:o.call(r)}}});w({name:"Polyline",props:{options:{type:Object,required:!0}},emits:E,setup(i,{emit:e}){return i=T(i,"options"),{polyline:z("Polyline",E,i,e)}},render:()=>null});w({name:"Polygon",props:{options:{type:Object,required:!0}},emits:E,setup(i,{emit:e}){return i=T(i,"options"),{polygon:z("Polygon",E,i,e)}},render:()=>null});let ke=E.concat(["bounds_changed"]);w({name:"Rectangle",props:{options:{type:Object,required:!0}},emits:ke,setup(i,{emit:e}){return i=T(i,"options"),{rectangle:z("Rectangle",ke,i,e)}},render:()=>null});let Ce=E.concat(["center_changed","radius_changed"]);var Ke=w({name:"Circle",props:{options:{type:Object,required:!0}},emits:Ce,setup(i,{emit:e}){return i=T(i,"options"),{circle:z("Circle",Ce,i,e)}},render:()=>null}),Ve=w({props:{position:{type:String,required:!0},index:{type:Number,default:1}},emits:["content:loaded"],setup(i,{emit:e}){let t=m(null),r=k(q,m()),o=k(j,m()),n=k(Le,m(!1)),a=m(!1),s=x([n,o,t],([u,p,c])=>{p&&u&&c&&(d(i.position),a.value=!0,e("content:loaded"),setTimeout(s,0))},{immediate:!0}),d=u=>{r.value&&o.value&&t.value&&r.value.controls[o.value.ControlPosition[u]].push(t.value)},l=u=>{if(r.value&&o.value){let p=null;u=o.value.ControlPosition[u],r.value.controls[u].forEach((c,h)=>{c===t.value&&(p=h)}),p!==null&&r.value.controls[u].removeAt(p)}};return L(()=>l(i.position)),x(()=>i.position,(u,p)=>{l(p),d(u)}),x(()=>i.index,u=>{u&&t.value&&(t.value.index=i.index)}),{controlRef:t,showContent:a}}});let We={ref:"controlRef"};Ve.render=function(i){return y(),M(S,null,[le(`
    v-show must be used instead of v-if otherwise there
    would be no rendered content pushed to the map controls
  `),Be(P("div",We,[J(i.$slots,"default")],512),[[Ne,i.showContent]])],2112)};let we="closeclick content_changed domready position_changed visible zindex_changed".split(" ");var Te=w({inheritAttrs:!1,props:{options:{type:Object,default:()=>({})}},emits:we,setup(i,{slots:e,emit:t}){let r=m(),o=m(),n=k(q,m()),a=k(j,m()),s=k(Pe,m()),d,l=K(()=>{var u;return(u=e.default)===null||u===void 0?void 0:u.call(e).some(p=>p.type!==Ie)});return ae(()=>{x([n,()=>i.options],([,u],[p,c])=>{p=!F(u,c)||n.value!==p,n.value&&a.value&&p&&(r.value?(r.value.setOptions({...u,content:l.value?o.value:u.content}),s.value||r.value.open({map:n.value})):(r.value=_(new a.value.InfoWindow({...u,content:l.value?o.value:u.content})),s.value?d=s.value.addListener("click",()=>{r.value&&r.value.open({map:n.value,anchor:s.value})}):r.value.open({map:n.value}),we.forEach(h=>{var g;(g=r.value)===null||g===void 0||g.addListener(h,v=>t(h,v))})))},{immediate:!0})}),L(()=>{var u;d&&d.remove(),r.value&&((u=a.value)===null||u===void 0||u.event.clearInstanceListeners(r.value),r.value.close())}),{infoWindow:r,infoWindowRef:o,hasSlotContent:l}}});pe(`
.info-window-wrapper[data-v-5b373d6e] {
  display: none;
}
.mapdiv .info-window-wrapper[data-v-5b373d6e] {
  display: inline-block;
}
`);let Je=ie();ne("data-v-5b373d6e");let Xe={key:0,class:"info-window-wrapper"};se();let Ye=Je(i=>i.hasSlotContent?(y(),M("div",Xe,[P("div",Se({ref:"infoWindowRef"},i.$attrs),[J(i.$slots,"default",{},void 0,!0)],16)])):le("v-if",!0));Te.render=Ye;Te.__scopeId="data-v-5b373d6e";function re(i,e,t,r,o,n){if(!(o-r<=t)){var a=r+o>>1;qe(i,e,a,r,o,n%2),re(i,e,t,r,a-1,n+1),re(i,e,t,a+1,o,n+1)}}function qe(i,e,t,r,o,n){for(;o>r;){if(600<o-r){var a=o-r+1,s=t-r+1,d=Math.log(a),l=.5*Math.exp(2*d/3);d=.5*Math.sqrt(d*l*(a-l)/a)*(0>s-a/2?-1:1),qe(i,e,t,Math.max(r,Math.floor(t-s*l/a+d)),Math.min(o,Math.floor(t+(a-s)*l/a+d)),n)}for(a=e[2*t+n],s=r,l=o,R(i,e,r,t),e[2*o+n]>a&&R(i,e,r,o);s<l;){for(R(i,e,s,l),s++,l--;e[2*s+n]<a;)s++;for(;e[2*l+n]>a;)l--}e[2*r+n]===a?R(i,e,r,l):(l++,R(i,e,l,o)),l<=t&&(r=l+1),t<=l&&(o=l-1)}}function R(i,e,t,r){te(i,t,r),te(e,2*t,2*r),te(e,2*t+1,2*r+1)}function te(i,e,t){let r=i[e];i[e]=i[t],i[t]=r}let Qe=i=>i[0],et=i=>i[1];class xe{constructor(e,t=Qe,r=et,o=64,n=Float64Array){this.nodeSize=o,this.points=e;let a=this.ids=new(65536>e.length?Uint16Array:Uint32Array)(e.length);n=this.coords=new n(2*e.length);for(let s=0;s<e.length;s++)a[s]=s,n[2*s]=t(e[s]),n[2*s+1]=r(e[s]);re(a,n,o,0,a.length-1,0)}range(e,t,r,o){{var n=this.ids,a=this.coords,s=this.nodeSize;let l=[0,n.length-1,0],u=[],p,c;for(;l.length;){var d=l.pop();let h=l.pop(),g=l.pop();if(h-g<=s){for(d=g;d<=h;d++)p=a[2*d],c=a[2*d+1],p>=e&&p<=r&&c>=t&&c<=o&&u.push(n[d]);continue}let v=Math.floor((g+h)/2);p=a[2*v],c=a[2*v+1],p>=e&&p<=r&&c>=t&&c<=o&&u.push(n[v]);let f=(d+1)%2;(d===0?e<=p:t<=c)&&(l.push(g),l.push(v-1),l.push(f)),(d===0?r>=p:o>=c)&&(l.push(v+1),l.push(h),l.push(f))}e=u}return e}within(e,t,r){{var o=this.ids,n=this.coords,a=this.nodeSize;let p=[0,o.length-1,0],c=[],h=r*r;for(;p.length;){var s=p.pop();let g=p.pop();var d=p.pop();if(g-d<=a){for(s=d;s<=g;s++){d=n[2*s]-e;var l=n[2*s+1]-t;d=d*d+l*l,d<=h&&c.push(o[s])}continue}l=Math.floor((d+g)/2);let v=n[2*l],f=n[2*l+1];{var u=v-e;let C=f-t;u=u*u+C*C}u<=h&&c.push(o[l]),u=(s+1)%2,(s===0?e-r<=v:t-r<=f)&&(p.push(d),p.push(l-1),p.push(u)),(s===0?e+r>=v:t+r>=f)&&(p.push(l+1),p.push(g),p.push(u))}e=c}return e}}let tt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:i=>i},W=Math.fround||(i=>e=>(i[0]=+e,i[0]))(new Float32Array(1));class rt{constructor(e){this.options=A(Object.create(tt),e),this.trees=Array(this.options.maxZoom+1)}load(e){let{log:t,minZoom:r,maxZoom:o,nodeSize:n}=this.options;t&&console.time("total time");var a=`prepare ${e.length} points`;t&&console.time(a),this.points=e;let s=[];for(let d=0;d<e.length;d++)e[d].geometry&&s.push(it(e[d],d));for(this.trees[o+1]=new xe(s,be,Me,n,Float32Array),t&&console.timeEnd(a),e=o;e>=r;e--)a=+Date.now(),s=this._cluster(s,e),this.trees[e]=new xe(s,be,Me,n,Float32Array),t&&console.log("z%d: %d clusters in %dms",e,s.length,+Date.now()-a);return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;var o=Math.max(-90,Math.min(90,e[1])),n=e[2]===180?180:((e[2]+180)%360+360)%360-180;let a=Math.max(-90,Math.min(90,e[3]));if(360<=e[2]-e[0])r=-180,n=180;else if(r>n){var s=this.getClusters([r,o,180,a],t);return o=this.getClusters([-180,o,n,a],t),s.concat(o)}t=this.trees[this._limitZoom(t)],n=t.range(r/360+.5,U(a),n/360+.5,U(o)),o=[];for(s of n)n=t.points[s],o.push(n.numPoints?_e(n):this.points[n.index]);return o}getChildren(e){var t=this._getOriginId(e),r=this._getOriginZoom(e);let o=this.trees[r];if(!o||(t=o.points[t],!t))throw Error("No cluster with the specified id.");t=o.within(t.x,t.y,this.options.radius/(this.options.extent*Math.pow(2,r-1))),r=[];for(let n of t)t=o.points[n],t.parentId===e&&r.push(t.numPoints?_e(t):this.points[t.index]);if(r.length===0)throw Error("No cluster with the specified id.");return r}getLeaves(e,t,r){let o=[];return this._appendLeaves(o,e,t||10,r||0,0),o}getTile(e,t,r){let o=this.trees[this._limitZoom(e)];e=Math.pow(2,e);let{extent:n,radius:a}=this.options,s=a/n,d=(r-s)/e,l=(r+1+s)/e,u={features:[]};return this._addTileFeatures(o.range((t-s)/e,d,(t+1+s)/e,l),o.points,t,r,e,u),t===0&&this._addTileFeatures(o.range(1-s/e,d,1,l),o.points,e,r,e,u),t===e-1&&this._addTileFeatures(o.range(0,d,s/e,l),o.points,-1,r,e,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom&&(e=this.getChildren(e),t++,e.length===1);)e=e[0].properties.cluster_id;return t}_appendLeaves(e,t,r,o,n){t=this.getChildren(t);for(let a of t)if((t=a.properties)&&t.cluster?n=n+t.point_count<=o?n+t.point_count:this._appendLeaves(e,t.cluster_id,r,o,n):n<o?n++:e.push(a),e.length===r)break;return n}_addTileFeatures(e,t,r,o,n,a){for(let l of e){e=t[l];let u=e.numPoints;var s=void 0;let p;var d=void 0;u?(s=je(e),p=e.x,d=e.y):(d=this.points[e.index],s=d.properties,p=d.geometry.coordinates[0]/360+.5,d=U(d.geometry.coordinates[1])),s={type:1,geometry:[[Math.round(this.options.extent*(p*n-r)),Math.round(this.options.extent*(d*n-o))]],tags:s};let c;u?c=e.id:this.options.generateId?c=e.index:this.points[e.index].id&&(c=this.points[e.index].id),c!==void 0&&(s.id=c),a.features.push(s)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){let r=[],{radius:o,extent:n,reduce:a,minPoints:s}=this.options,d=o/(n*Math.pow(2,t));for(let h=0;h<e.length;h++){var l=e[h];if(l.zoom<=t)continue;l.zoom=t;let g=this.trees[t+1];var u=g.within(l.x,l.y,d),p=l.numPoints||1;let v=p;for(let f of u){var c=g.points[f];c.zoom>t&&(v+=c.numPoints||1)}if(v>p&&v>=s){c=l.x*p;let f=l.y*p;p=a&&1<p?this._map(l,!0):null;let C=(h<<5)+(t+1)+this.points.length;for(let me of u){if(u=g.points[me],u.zoom<=t)continue;u.zoom=t;let X=u.numPoints||1;c+=u.x*X,f+=u.y*X,u.parentId=C,a&&(p||(p=this._map(l,!0)),a(p,this._map(u)))}l.parentId=C,r.push(ot(c/v,f/v,C,v,p))}else if(r.push(l),1<v)for(let f of u)l=g.points[f],l.zoom<=t||(l.zoom=t,r.push(l))}return r}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t){if(e.numPoints)return t?A({},e.properties):e.properties;e=this.points[e.index].properties;let r=this.options.map(e);return t&&r===e?A({},r):r}}function ot(i,e,t,r,o){return{x:W(i),y:W(e),zoom:1/0,id:t,parentId:-1,numPoints:r,properties:o}}function it(i,e){let[t,r]=i.geometry.coordinates;return{x:W(t/360+.5),y:W(U(r)),zoom:1/0,index:e,parentId:-1}}function _e(i){var e=i.id,t=je(i);return{type:"Feature",id:e,properties:t,geometry:{type:"Point",coordinates:[360*(i.x-.5),360*Math.atan(Math.exp((180-360*i.y)*Math.PI/180))/Math.PI-90]}}}function je(i){let e=i.numPoints,t=1e4<=e?`${Math.round(e/1e3)}k`:1e3<=e?`${Math.round(e/100)/10}k`:e;return A(A({},i.properties),{cluster:!0,cluster_id:i.id,point_count:e,point_count_abbreviated:t})}function U(i){return i=Math.sin(i*Math.PI/180),i=.5-.25*Math.log((1+i)/(1-i))/Math.PI,0>i?0:1<i?1:i}function A(i,e){for(let t in e)i[t]=e[t];return i}function be(i){return i.x}function Me(i){return i.y}class oe{constructor({markers:e,position:t}){this.markers=e,t&&(this._position=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t))}get bounds(){if(this.markers.length!==0||this._position)return this.markers.reduce((e,t)=>e.extend(t.getPosition()),new google.maps.LatLngBounds(this._position,this._position))}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>e.getVisible()).length}push(e){this.markers.push(e)}delete(){this.marker&&(this.marker.setMap(null),delete this.marker),this.markers.length=0}}class nt{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return st(e)}}let st=i=>i.map(e=>new oe({position:e.getPosition(),markers:[e]}));class lt extends nt{constructor(e){var{maxZoom:t,radius:r=60}=e,o=["maxZoom","radius"],n={},a;for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>o.indexOf(a)&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)0>o.indexOf(a[s])&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}super({maxZoom:t}),this.superCluster=new rt(Object.assign({maxZoom:this.maxZoom,radius:r},n)),this.state={zoom:null}}calculate(e){let t=!1;if(!F(e.markers,this.markers)){t=!0,this.markers=[...e.markers];var r=this.markers.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.getPosition().lng(),o.getPosition().lat()]},properties:{marker:o}}));this.superCluster.load(r)}return r={zoom:e.map.getZoom()},t||this.state.zoom>this.maxZoom&&r.zoom>this.maxZoom||(t=t||!F(this.state,r)),this.state=r,t&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:t}}cluster({map:e}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(e.getZoom())).map(this.transformCluster.bind(this))}transformCluster({geometry:{coordinates:[e,t]},properties:r}){return r.cluster?new oe({markers:this.superCluster.getLeaves(r.cluster_id,1/0).map(o=>o.properties.marker),position:new google.maps.LatLng({lat:t,lng:e})}):(e=r.marker,new oe({markers:[e],position:e.getPosition()}))}}class at{constructor(e,t){this.markers={sum:e.length},e=t.map(o=>o.count);let r=e.reduce((o,n)=>o+n,0);this.clusters={count:t.length,markers:{mean:r/t.length,sum:r,min:Math.min(...e),max:Math.max(...e)}}}}class ut{render({count:e,position:t},r){return r=window.btoa(`
  <svg fill="${e>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240">
    <circle cx="120" cy="120" opacity=".6" r="70" />
    <circle cx="120" cy="120" opacity=".3" r="90" />
    <circle cx="120" cy="120" opacity=".2" r="110" />
  </svg>`),new google.maps.Marker({position:t,icon:{url:`data:image/svg+xml;base64,${r}`,scaledSize:new google.maps.Size(45,45)},label:{text:String(e),color:"rgba(255,255,255,0.9)",fontSize:"12px"},title:`Cluster of ${e} markers`,zIndex:Number(google.maps.Marker.MAX_ZINDEX)+e})}}class de{constructor(){var e=de,t=google.maps.OverlayView;for(let r in t.prototype)e.prototype[r]=t.prototype[r]}}var I,ce=I||(I={});ce.CLUSTERING_BEGIN="clusteringbegin";ce.CLUSTERING_END="clusteringend";ce.CLUSTER_CLICK="click";let pt=(i,e,t)=>{t.fitBounds(e.bounds)};class dt extends de{constructor({map:e,markers:t=[],algorithm:r=new lt({}),renderer:o=new ut,onClusterClick:n=pt}){super(),this.markers=[...t],this.clusters=[],this.algorithm=r,this.renderer=o,this.onClusterClick=n,e&&this.setMap(e)}addMarker(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}addMarkers(e,t){e.forEach(r=>{this.addMarker(r,!0)}),t||this.render()}removeMarker(e,t){let r=this.markers.indexOf(e);return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),t||this.render(),!0)}removeMarkers(e,t){let r=!1;return e.forEach(o=>{r=this.removeMarker(o,!0)||r}),r&&!t&&this.render(),r}clearMarkers(e){this.markers.length=0,e||this.render()}render(){let e=this.getMap();if(e instanceof google.maps.Map&&this.getProjection()){google.maps.event.trigger(this,I.CLUSTERING_BEGIN,this);let{clusters:t,changed:r}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});(r||r==null)&&(this.reset(),this.clusters=t,this.renderClusters()),google.maps.event.trigger(this,I.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>e.setMap(null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){let e=new at(this.markers,this.clusters),t=this.getMap();this.clusters.forEach(r=>{r.markers.length===1?r.marker=r.markers[0]:(r.marker=this.renderer.render(r,e),this.onClusterClick&&r.marker.addListener("click",o=>{google.maps.event.trigger(this,I.CLUSTER_CLICK,r),this.onClusterClick(o,r,t)})),r.marker.setMap(t)})}}let Oe=Object.values(I);w({name:"MarkerCluster",props:{options:{type:Object,default:()=>({})}},emits:Oe,setup(i,{emit:e,expose:t,slots:r}){let o=m(),n=k(q,m()),a=k(j,m());return Z(Ee,o),x(n,()=>{n.value&&(o.value=_(new dt({map:n.value,...i.options})),Oe.forEach(s=>{var d;(d=o.value)===null||d===void 0||d.addListener(s,l=>e(s,l))}))},{immediate:!0}),L(()=>{var s;o.value&&((s=a.value)===null||s===void 0||s.event.clearInstanceListeners(o.value),o.value.clearMarkers(),o.value.setMap(null))}),t({markerCluster:o}),()=>{var s;return(s=r.default)===null||s===void 0?void 0:s.call(r)}}});var he=w({inheritAttrs:!1,props:{options:{type:Object,required:!0}},setup(i,{slots:e,emit:t}){let r=m(),o=m(),n=K(()=>{var s;return(s=e.default)===null||s===void 0?void 0:s.call(e).some(d=>d.type!==Ie)}),a=K(()=>({...i.options,element:r.value}));return ae(()=>{o=z(V,[],a,t)}),{customMarkerRef:r,customMarker:o,hasSlotContent:n}}});pe(`
.custom-marker-wrapper[data-v-b9d5ec8a] {
  display: none;
}
.mapdiv .custom-marker-wrapper[data-v-b9d5ec8a] {
  display: inline-block;
}
`);let ct=ie();ne("data-v-b9d5ec8a");let ht={key:0,class:"custom-marker-wrapper"};se();let mt=ct(i=>i.hasSlotContent?(y(),M("div",ht,[P("div",Se({ref:"customMarkerRef",style:{cursor:i.$attrs.onClick?"pointer":void 0}},i.$attrs),[J(i.$slots,"default",{},void 0,!0)],16)])):le("v-if",!0));he.render=mt;he.__scopeId="data-v-b9d5ec8a";w({name:"HeatmapLayer",props:{options:{type:Object,default:()=>({})}},setup(i){let e=m(),t=k(q,m()),r=k(j,m());return x([t,()=>i.options],([,o],[n,a])=>{var s;if(n=!F(o,a)||t.value!==n,t.value&&r.value&&n){if(o=structuredClone(o),o.data&&!(o.data instanceof r.value.MVCArray)){let d=r.value.LatLng;o.data=(s=o.data)===null||s===void 0?void 0:s.map(l=>l instanceof d||"location"in l&&(l.location instanceof d||l.location===null)?l:"location"in l?{...l,location:new d(l.location)}:new d(l))}e.value?e.value.setOptions(o):e.value=_(new r.value.visualization.HeatmapLayer({...o,map:t.value}))}},{immediate:!0}),L(()=>{e.value&&e.value.setMap(null)}),{heatmapLayer:e}},render:()=>null});const gt=w({components:{GoogleMap:ue,Marker:Ue,Circle:Ke,CustomMarker:he},data(){return{lobby_name:ge(),proxyCircles:this.circles,proxyHunter:this.hunterProxy,proxyHunted:this.huntedProxy,hunterIcon:"https://firebasestorage.googleapis.com/v0/b/geohunt-dff18.appspot.com/o/icons%2Fhunter.png?alt=media&token=2bf806bd-98ab-467d-aba7-08270ceeef1b",markerOptions:{position:{lat:53.28375377364412,lng:-9.049084323437237},icon:{url:"https://firebasestorage.googleapis.com/v0/b/geohunt-dff18.appspot.com/o/icons%2Fhunted1.png?alt=media&token=cc5a6ae7-3119-4f93-b6e8-c3ce689bff4f",scaledSize:{width:20,height:20}}}}},mounted:function(){window.setInterval(()=>{window.scrollTo(500,0),this.getLocation()},5e3)},setup(){const i={lat:53.2740621,lng:-9.0534727},e="bc3210211695b110",t=[],r=[],o=[];return H(D(B(N()),ge()+"/users/"+ee().currentUser.uid+"/")).then(n=>{n.val().team=="hunter"?(document.getElementById("banner").innerText="a hunter",document.getElementById("roleArea").style="background-color: rgb(200,0,0)",document.getElementById("htmlTitle").innerText="GeoHunt - gone hunting"):document.getElementById("htmlTitle").innerText="GeoHunt - gone hiding"}),{center:i,mapID:e,circles:t,hunterProxy:r,huntedProxy:o}},methods:{drawCircle(i){this.proxyCircles.push({strokeColor:"#FF0000",strokOpacity:.7,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,center:i,radius:40})},drawHunter(i){this.proxyHunter.push({position:i})},drawHunted(i,e){this.proxyHunted.push({position:i,icon:e})},getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(i=>{const e={lat:i.coords.latitude,lng:i.coords.longitude};Ze(B(N(),this.lobby_name+"/users/"+ee().currentUser.uid),{location:e}),H(D(B(N()),this.lobby_name+"/users/"+ee().currentUser.uid+"/")).then(t=>{this.proxyCircles=[],this.proxyHunter=[],this.proxyHunted=[],t.val().team=="hunter"?H(D(B(N()),this.lobby_name+"/users/")).then(r=>{r.forEach(o=>{o.val().team=="hunter"?this.drawHunter(o.val().location):this.drawCircle(o.val().location)})}):t.val().team=="hunted"&&H(D(B(N()),this.lobby_name+"/users/")).then(r=>{r.forEach(o=>{o.val().team!="hunter"&&this.drawHunted(o.val().location,o.val().icon)})})})})}}}),vt=$("div",{id:"roleArea"},[Ae("You are "),$("span",{id:"banner"},"being hunted")],-1),ft=$("div",null,[$("img",{src:"https://firebasestorage.googleapis.com/v0/b/geohunt-dff18.appspot.com/o/icons%2Fhunter.png?alt=media&token=8dbbfdde-2972-4f21-84b0-a3415fea435d"})],-1),yt=["src"];function kt(i,e,t,r,o,n){const a=Y("Circle"),s=Y("CustomMarker"),d=Y("GoogleMap");return y(),O(S,null,[vt,P(d,{"api-key":"AIzaSyB0vMYrB2rlb-aDao6aMHbRqQg3oIlQby4",style:{width:"100%",height:"800px"},"map-id":i.mapID,center:i.center,zoom:15,streetViewControl:"false",mapTypeControl:!1,scaleControl:"false",zoomControl:"false",keyboardShortcuts:"false",scrollwheel:"true",navigationControl:!1,fullscreenControl:!1,draggable:"true",disableDefaultUI:"true",disableDoubleClickZoom:"false",gestureHandling:"greedy"},{default:Q(()=>[(y(!0),O(S,null,G(i.proxyCircles,l=>(y(),M(a,{options:l},null,8,["options"]))),256)),(y(!0),O(S,null,G(i.proxyHunter,l=>(y(),O("div",null,[P(s,{options:{position:l.position}},{default:Q(()=>[ft]),_:2},1032,["options"])]))),256)),(y(!0),O(S,null,G(i.proxyHunted,l=>(y(),M(s,{options:i.markerOptions},null,8,["options"]))),256)),(y(!0),O(S,null,G(i.proxyHunted,l=>(y(),M(s,{options:{position:l.position}},{default:Q(()=>[$("img",{src:l.icon},null,8,yt)]),_:2},1032,["options"]))),256))]),_:1},8,["map-id","center"])],64)}const xt=Re(gt,[["render",kt],["__file","/home/dave/Documents/geohunt-vue/geohunt-vue/src/pages/Game.vue"]]);export{xt as default};
